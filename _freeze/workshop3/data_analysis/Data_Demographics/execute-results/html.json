{
  "hash": "d62caef154462273a16f621104664d22",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Demographic Data Analysis\nformat:\n  html:\n    toc: true\n    toc-location: left\n    number-sections: false\n\nwebr:\n  packages: [\"tidyverse\", \"GGally\"]\nfilters:\n  - webr\n---\n\n\n\n\n```{webr-r}\n#| context: setup\n\n# Load required libraries\nlibrary(tidyverse)\n\n# Load required data files\n\n# demographic data files\ndownload.file('https://raw.githubusercontent.com/mafeeney/BM424workshop3/main/workshop3/data_sets/demographics_groupA.csv', 'demographics_groupA.csv')\n```\n\n# City Demographic Data Analysis\n\n## Demographic Data: Step 1--Load and Examine Your City's Demographic Data\n\nThe demographic data for your city is in a file `demographics_groupX.csv` (where you replace X with your group letter; e.g., the file for group A will be `demographics_groupA.csv`). You can load this using the `read_csv()` function. \n\nOnce you have loaded your data, you will want to examine it to ensure that it has loaded correctly, and to ensure that you understand how the data is structured. You can do this using `glimpse()`, which will summarize the number of rows and columns present in your data and give a glimpse of the columns; or by using `head()`, which will output the first part of your dataset.\n\nWhen you use the `head()` function, it displays the first six rows of your data by default. However, you can customize this to view a different number of rows by specifying the number of rows you want to see. The general syntax for the head() function with a specified number of rows is: head(data_frame, n) where data_frame is your data frame (in this case, demographic_data) and n is the number of rows you want to view. For example, if you want to view the first 10 rows of your data instead of the default 6, you can use the following command: `head(demographic_data, 10)`\n\n\n::: {.callout-important title=\"Task\"}\nUse the `WebR` cell below to load and examine your data.\n:::\n\n::: {.callout-tip collapse=\"true\"}\n## I need a hint!\n- Use `read.csv()` to load your data.\n- Use `head()` or `glimpse()` to examine your data.\n:::\n\n```{webr-r}\n# Use the read.csv(), and head() or glimpse() functions to load and examine your data.\n\n```\n\n::: {.callout-warning collapse=\"true\" title=\"Help! I'm stuck!\"}\nUse the `R` code below to load and examine your data.\n\n```r\n# Replace 'X' with your group letter to load the correct file\ndemographic_data <- read_csv(\"demographics_groupX.csv\")\n\n# View the first few rows of the data\nhead(demographic_data)\n\n# Alternatively, you can use glimpse() to get an overview of the data\nglimpse(demographic_data)\n```\n:::\n\n::: {.callout-note collapse=\"true\" title=\"Understanding your results\"}\n\nIf you ran `glimpse(demographic_data)`, your results probably look something like this: \n\n::: {.cell}\n\n```{.r .cell-code}\nRows: 60\nColumns: 3\n$ Year     <int> 2020, 2020, 2020, 2020, 2020, 2020, 2020, 2020, 2020, 2020, 2…\n$ Category <chr> \"Age: 0-14\", \"Age: 15-24\", \"Age: 25-44\", \"Age: 45-64\", \"Age: …\n$ Count    <int> 14992, 41866, 57453, 44526, 18384, 9669, 87828, 95062, 4000, …\n```\n:::\n\n\nWhile if you ran `head(demographic_data, 10)`, you will likely have seen something like this: \n\n::: {.cell}\n\n```{.r .cell-code}\n   Year             Category  Count\n1  2020            Age: 0-14  14992\n2  2020           Age: 15-24  41866\n3  2020           Age: 25-44  57453\n4  2020           Age: 45-64  44526\n5  2020           Age: 65-74  18384\n6  2020             Age: 75+   9669\n7  2020         Gender: Male  87828\n8  2020       Gender: Female  95062\n9  2020        Gender: Other   4000\n10 2020 Employment: Employed 127570\n```\n:::\n\n\nYou can tell from these looks at your demographic data, that it gives the number of people (Count) in different categories over the years. You can also tell (from `glimpse`) that there are 60 rows and 3 columns in your dataset; and the *type* of data in each column (int = integer, chr = character or string values).\n:::\n\n## Demographic Data: Step 2--Plotting Your Data\n\nNow that you have loaded and examined your data, you can visualize it by creating a plot. We'll use `ggplot2` from the tidyverse to plot counts for each category over the years.\n\nggplot2 is an R package for creating graphics and visualizations. It uses a systematic way of thinking about and building plots called the \"Grammar of Graphics\", which allows you to build graphs by combining independent components. Each graph can be built up of layers, which are added to the base plot using the + operator. \n\nYou will want to point ggplot2 at the data you want to visualise (the data frame; in this case, `demographic_data`), and add geometric objects (geoms) such as points or lines showing your data. You will want to define the visual properties (aesthetics, or aes) of the plot (e.g., the x and y positions, colours/shapes/sizes of objects in the plot). You may also want to customise the graph further, for example by selecting a theme and/or editing the labels on the graph.\n\n::: {.callout-important title=\"Task\"}\nUse the `WebR` cell below to create a plot of the counts for each category over the years.\n:::\n\n::: {.callout-tip collapse=\"true\"}\n## I need a hint!\n- Use `ggplot()` to initialize the plot with your data and aesthetic mappings.\n- Add `geom_line()` to create line plots.\n- Use `labs()` to add titles and labels to your plot.\n- Apply a theme, such as `theme_minimal()`, to control the appearance of your plot. You could also choose another [theme](https://ggplot2.tidyverse.org/reference/ggtheme.html).\n:::\n\n```{webr-r}\n# Use ggplot() to create a plot of the counts for each category over the years.\n\n```\n\n::: {.callout-warning collapse=\"true\"}\n## Help! I'm stuck!\n\nUse the `R` code below to create your plot.\n\n```r\n# Create the plot\nggplot(demographic_data, aes(x = Year, y = Count, color = Category)) + #This initializes the plot with `demographic_data`, mapping the `Year` to the x-axis, `Count` to the y-axis, and `Category` to the color of the lines.\n  geom_line() + #This adds line plots to represent the data.\n  labs(title = \"Category Counts by Year\",\n       x = \"Year\",\n       y = \"Count\",\n       color = \"Category\") + #This adds a title and labels to the plot.\n  theme_minimal() #This applies a minimal theme for a clean and simple plot appearance.\n```\n:::\n\n::: {.callout-note collapse=\"true\" title=\"Understanding your results\"}\nIf you ran the command below:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(demographic_data, aes(x = Year, y = Count, color = Category)) + #This initializes the plot with `demographic_data`, mapping the `Year` to the x-axis, `Count` to the y-axis, and `Category` to the color of the lines.\n  geom_line() + #This adds line plots to represent the data.\n  labs(title = \"Category Counts by Year\",\n       x = \"Year\",\n       y = \"Count\",\n       color = \"Category\") + #This adds a title and labels to the plot.\n  theme_minimal() #This applies a minimal theme for a clean and simple plot appearance. \n```\n:::\n\n\nyou have probably generated a plot that looks something like this: \n\n![initial plot of demographic_data](data-images/demog-plot1.png){ width=50% height=50% }\n\n:::  \n## Demographic Data: Step 3--Filtering and Plotting Your Data\n\nYou can see from examining and plotting your data that there are three different categories present in your demographic dataset: age, gender, and employment. It may be more helpful to create a plot specifically for each of these categories. For example, you might first filter the data based on age and then plot it. You may also similarly explore the other demographic categories (employment and gender). \n\n::: {.callout-important title=\"Task\"}\nUse the `WebR` cell below to filter your data for age-related categories and create a plot.\n:::\n\n::: {.callout-tip collapse=\"true\"}\n## I need a hint!\n- You may find it helpful to define a new variable with an informative name to store your filtered data.\n- Use `filter()` filter the data.\n- Use `str_detect()` to find categories containing \"Age\". Note that this will match strings quite literally (capitalisation matters!).\n- Plot the new data with `ggplot()` and `geom_line()`. You can modify the plot (i.e. to add labels, adjust the theme, etc.) as you did in the previous step.\n:::\n\n```{webr-r}\n# Filter your data for \"Age\" and other categories and create plots of the filtered data.\n\n\n```\n\n::: {.callout-warning collapse=\"true\"}\n## Help! I'm stuck!\n\nUse the `R` code below to filter your data and create the plot.\n\n```r\n# Filter data for Age categories\n# \nage_data <- demographic_data %>% filter(str_detect(Category, \"Age\"))  #Filters the `demographic_data` to include only rows where the `Category` column contains the word \"Age\"\n\n# Create a plot for Age categories\nggplot(age_data, aes(x = Year, y = Count, color = Category)) + #This will initialize a plot with the filtered `age_data`, mapping `Year` to the x-axis, `Count` to the y-axis, and `Category` to the color of the lines.\n  geom_line() + #This adds line plots to represent the age-category data.\n  labs(x = \"Year\",\n       y = \"Total Count\") + #This adds labels to the x and y axes.\n  theme_minimal() #This applies a minimal theme\n  \n# Filter data for Gender categories\ngender_data <- demographic_data %>% filter(str_detect(Category, \"Gender\"))\n\n# Create a plot for Gender categories\nggplot(gender_data, aes(x = Year, y = Count, color = Category)) + #This will initialize a plot with the filtered `gender_data`, mapping `Year` to the x-axis, `Count` to the y-axis, and `Category` to the color of the lines.\n  geom_line() + #This adds line plots to represent the gender-category data.\n  labs(x = \"Year\",\n       y = \"Total Count\") + #This adds labels to the x and y axes.\n  theme_minimal() #This applies a minimal theme\n\n# Filter data for Employment categories\nemployment_data <- demographic_data %>% filter(str_detect(Category, \"Employment\"))\n\n# Create a plot for Employment categories\nggplot(employment_data, aes(x = Year, y = Count, color = Category)) + #This will initialize a plot with the filtered `employment_data`, mapping `Year` to the x-axis, `Count` to the y-axis, and `Category` to the color of the lines.\n  geom_line() + #This adds line plots to represent the employment-category data.\n  labs(x = \"Year\",\n       y = \"Total Count\") + #This adds labels to the x and y axes.\n  theme_minimal() #This applies a minimal theme\n```\n:::\n\n## Demographic Data: Step 4--Summarizing Data for the Current Year\n\nNow that you have filtered and plotted your demographic data for different categories, the next step is to focus on the data for the current year (2024). We will filter the data for the year 2024, view the summarized data, and then calculate the total city population for that year. This will give us an overall picture of the city's population distribution in 2024.\n\nTo accomplish this, we will use several functions from the `dplyr` and `stringr` packages in R:\n\n- **`filter()`**: This function is used to subset the rows of a data frame that meet certain conditions. In our case, we'll use it to select rows where the year is 2024.\n  \n- **`print()`**: This basic R function displays the data or results in the console. We'll use it to view the filtered data for 2024.\n  \n- **`mutate()`**: This function adds new variables or modifies existing ones in a data frame. We'll use it to create a new column that extracts the general category from the `Category` column.\n  \n- **`str_extract()`**: Part of the `stringr` package, this function extracts matching patterns from strings. We'll use it to extract the part of the `Category` string before the colon (`:`).\n  \n- **`group_by()`**: This function groups the data by one or more variables. Grouping is necessary before applying summary functions like `sum()`.\n  \n- **`summarise()`**: This function creates summary statistics for each group defined by `group_by()`. We'll use it to calculate the total count for each general category by summing the counts within each group.\n\n\n::: {.callout-important title=\"Task\"}\nUse the `WebR` cell below to filter your data for the year 2024, view the summarized data, and calculate the total city population.\n:::\n\n::: {.callout-tip collapse=\"true\"}\n## I need a hint!\n- Use `filter()` to select rows where the `Year` is 2024.\n- Use `print()` to display the summarized data for 2024.\n- To calculate the total city population, extract the general category using `str_extract()` and group by this new category.\n- Sum the `Count` for each category using `summarise()`.\n:::\n\n```{webr-r}\n# Filter your data for the current year, view the summarized data, and calculate the total city population.\n\n\n```\n\n::: {.callout-warning collapse=\"true\"}\n## Help! I'm stuck!\n\nUse the `R` code below to filter your data, view the summarized data, and calculate the total city population.\n\n```r\n# Step 4: Filter data for the current year\nsummary_data_2024 <- demographic_data %>%\n  filter(Year == 2024)  # Filters the data to include only rows where the Year column is 2024\n\n# View the summarized data for the current year\nprint(summary_data_2024)  # Prints the filtered data for the year 2024\n\n# Calculate total city population in 2024\n# Extract the general category and sum the counts\nresult <- summary_data_2024 %>%\n  mutate(GeneralCategory = str_extract(Category, \"^[^:]+\")) %>%  # Extracts the general category from the Category column\n  group_by(GeneralCategory) %>%  # Groups the data by the new GeneralCategory\n  summarise(TotalCount = sum(Count))  # Sums the Count for each general category\n\n# Print the result\nprint(result)  # Prints the summarized total counts for each general category\n```\n:::\n\n## WebR Playground\n\n```{webr-r}\n# Use this WebR cell to experiment with any additional data visualisation(s)  you would like to perform with your pandemic data\n```\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}